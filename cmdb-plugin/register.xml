<?xml version="1.0" encoding="UTF-8"?>
<package name="wecmdb" version="{{VERSION}}"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:noNamespaceSchemaLocation="plugin-config-v2.xsd">

    <!-- 1.依赖分析 - 描述运行本插件包需要的其他插件包 -->
    <packageDependencies>
    </packageDependencies>
         
    <!-- 2.菜单注入 - 描述运行本插件包需要注入的菜单 -->
 <menus>
        <menu code='DESIGNING_CI_DATA_ENQUIRY' cat='DESIGNING' displayName="CI Data Enquiry" localDisplayName="CI数据查询">/wecmdb/designing/ci-data-enquiry</menu>
        <menu code='DESIGNING_CI_INTEGRATED_QUERY_EXECUTION' cat='DESIGNING' displayName="CI Integrated Enquiry" localDisplayName="CI综合查询">/wecmdb/designing/ci-integrated-query-execution</menu>
        <menu code='CMDB_DESIGNING_ENUM_ENQUIRY' cat='DESIGNING' displayName="Enum Enquiry" localDisplayName="枚举数据查询">/wecmdb/designing/enum-enquiry</menu>

        <menu code='DESIGNING_CI_DATA_MANAGEMENT' cat='DESIGNING' displayName="CI Data Management" localDisplayName="CI数据管理">/wecmdb/designing/ci-data-management</menu>
        <menu code='DESIGNING_CI_INTEGRATED_QUERY_MANAGEMENT' cat='DESIGNING' displayName="CI Integrated Enquiry Management" localDisplayName="CI综合查询管理">/wecmdb/designing/ci-integrated-query-management</menu>
        <menu code='CMDB_DESIGNING_ENUM_MANAGEMENT' cat='DESIGNING' displayName="Enum Management" localDisplayName="枚举数据管理">/wecmdb/designing/enum-management</menu>

        <menu code='IDC_PLANNING_DESIGN' cat='DESIGNING' displayName="IDC Planning Design" localDisplayName="机房规划设计">/wecmdb/view-management/idc-planning-design</menu>
        <menu code='IDC_RESOURCE_PLANNING' cat='DESIGNING' displayName="IDC Resource Plan" localDisplayName="机房资源规划">/wecmdb/view-management/idc-resource-planning</menu>
        <menu code='APPLICATION_ARCHITECTURE_DESIGN' cat='DESIGNING' displayName="App Architecture Design" localDisplayName="应用架构设计">/wecmdb/view-management/application-architecture-design</menu>
        <menu code='APPLICATION_DEPLOYMENT_DESIGN' cat='DESIGNING' displayName="App Deployment Design" localDisplayName="应用部署设计">/wecmdb/view-management/application-deployment-design</menu>

        <menu code='ADMIN_CMDB_MODEL_MANAGEMENT' cat='ADMIN' displayName="CMDB Modeling" localDisplayName="CMDB模型管理">/wecmdb/admin/cmdb-model-management</menu>
        <menu code='CMDB_ADMIN_BASE_DATA_MANAGEMENT' cat='ADMIN' displayName="CMDB Base Datas" localDisplayName="CMDB基础数据管理">/wecmdb/admin/base-data-management</menu>
        <menu code='ADMIN_QUERY_LOG' cat='ADMIN' displayName="CMDB Logs" localDisplayName="CMDB日志查询">/wecmdb/admin/query-log</menu>

        <menu code='MENU_ADMIN_PERMISSION_MANAGEMENT' cat='ADMIN' displayName="CMDB Permissions" localDisplayName="CMDB权限管理">/wecmdb/admin/permission-management</menu>
    </menus>

    <!-- 3.数据模型 - 描述本插件包的数据模型,并且描述和Framework数据模型的关系 -->
    <dataModel isDynamic="true">
    </dataModel>

    <!-- 4.系统参数 - 描述运行本插件包需要的系统参数 -->
    <systemParameters>
    </systemParameters>

    <!-- 5.权限设定 -->
    <authorities>
        <authority systemRoleName="SUPER_ADMIN" >
            <menu code="DESIGNING_CI_DATA_ENQUIRY" />
            <menu code="DESIGNING_CI_INTEGRATED_QUERY_EXECUTION" />
            <menu code="CMDB_DESIGNING_ENUM_ENQUIRY" />
            <menu code="DESIGNING_CI_DATA_MANAGEMENT" />
            <menu code="DESIGNING_CI_INTEGRATED_QUERY_MANAGEMENT" />
            <menu code="CMDB_DESIGNING_ENUM_MANAGEMENT" />
            <menu code="IDC_PLANNING_DESIGN" />
            <menu code="IDC_RESOURCE_PLANNING" />
            <menu code="APPLICATION_ARCHITECTURE_DESIGN" />
            <menu code="APPLICATION_DEPLOYMENT_DESIGN" />
            <menu code="ADMIN_CMDB_MODEL_MANAGEMENT" />
            <menu code="ADMIN_PERMISSION_MANAGEMENT" />
            <menu code="CMDB_ADMIN_BASE_DATA_MANAGEMENT" />
            <menu code="ADMIN_QUERY_LOG" />
            <menu code="ADMIN_USER_PASSWORD_MANAGEMENT" />
        </authority >
    </authorities>

    <!-- 6.运行资源 - 描述部署运行本插件包需要的基础资源(如主机、虚拟机、容器、数据库等) -->
    <resourceDependencies>
        <docker imageName="wecmdb:{{VERSION}}" containerName="wecmdb-{{VERSION}}" portBindings="{{ALLOCATE_PORT}}:8081" volumeBindings="{{BASE_MOUNT_PATH}}/wecmdb/log:/log" envVariables="DB_HOST={{DB_HOST}},DB_PORT={{DB_PORT}},DB_SCHEMA={{DB_SCHEMA}},DB_USER={{DB_USER}},DB_PWD={{DB_PWD}}"/>
        <mysql schema="wecmdb_embedded" initFileName="init.sql" upgradeFileName="upgrade.sql"/>
    </resourceDependencies>

    <!-- 7.插件列表 - 描述插件包中单个插件的输入和输出 -->
    <plugins>
        <plugin id="ci-data-confirm" name="CI Data Confirmation">
            <interface action="confirm" path="/wecmdb/data/confirm" httpMethod='POST'>
                <inputParameters>
                    <parameter datatype="string" mappingType='context' required='Y'>guid</parameter>
                </inputParameters>
                <outputParameters>
                    <parameter datatype="string">status</parameter>
                    <parameter datatype="string">message</parameter>
                    <parameter datatype="string">guid</parameter>
                    <parameter datatype="string">fixed_date</parameter>
                </outputParameters>
            </interface>
        </plugin>
    </plugins>
</package>
